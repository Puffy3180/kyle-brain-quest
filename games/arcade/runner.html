<!DOCTYPE html>
<html>
<head>
    <title>T-Rex Runner</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500&display=swap" rel="stylesheet">
    <style>
        body { background: #fff; color: #333; font-family: 'Space Grotesk', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        canvas { border-bottom: 2px solid #333; background: #fafafa; }
    </style>
</head>
<body>
    <canvas id="game" width="600" height="200"></canvas>
    <p>Space or Up to Jump</p>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');

        // Game State
        let frames = 0;
        let score = 0;
        let gameSpeed = 5;
        let isGameOver = false;

        // Dino
        const dino = {
            x: 50,
            y: 160,
            w: 40,
            h: 40,
            vy: 0,
            jumpStrength: -12,
            gravity: 0.6,
            grounded: true,
            draw: function() {
                ctx.fillStyle = '#333';
                ctx.fillRect(this.x, this.y, this.w, this.h);
            },
            update: function() {
                this.vy += this.gravity;
                this.y += this.vy;

                // Ground collision
                if (this.y > 160) {
                    this.y = 160;
                    this.vy = 0;
                    this.grounded = true;
                } else {
                    this.grounded = false;
                }
            },
            jump: function() {
                if (this.grounded) {
                    this.vy = this.jumpStrength;
                    this.grounded = false;
                }
            }
        };

        // Obstacles
        const obstacles = [];
        
        class Cactus {
            constructor() {
                this.x = canvas.width;
                this.y = 160;
                this.w = 20;
                this.h = 40;
                this.passed = false;
            }
            draw() {
                ctx.fillStyle = '#d63031';
                ctx.fillRect(this.x, this.y, this.w, this.h);
            }
            update() {
                this.x -= gameSpeed;
            }
        }

        function spawnObstacle() {
            // Random spawn rate
            if (frames % 100 === 0) { 
                if (Math.random() > 0.5) {
                    obstacles.push(new Cactus());
                }
            }
        }

        function checkCollisions() {
            for (let i = 0; i < obstacles.length; i++) {
                let obs = obstacles[i];
                
                // AABB Collision
                if (dino.x < obs.x + obs.w &&
                    dino.x + dino.w > obs.x &&
                    dino.y < obs.y + obs.h &&
                    dino.y + dino.h > obs.y) {
                    isGameOver = true;
                }

                // Score
                if (obs.x + obs.w < dino.x && !obs.passed) {
                    score++;
                    obs.passed = true;
                    // Increase speed every 5 points
                    if(score % 5 === 0) gameSpeed += 0.5;
                }
            }
        }

        function resetGame() {
            isGameOver = false;
            score = 0;
            gameSpeed = 5;
            frames = 0;
            obstacles.length = 0;
            dino.y = 160;
            dino.vy = 0;
            loop();
        }

        function loop() {
            if (isGameOver) {
                ctx.fillStyle = "rgba(0,0,0,0.5)";
                ctx.fillRect(0,0,canvas.width, canvas.height);
                ctx.fillStyle = "white";
                ctx.font = "30px Space Grotesk";
                ctx.fillText("Game Over", 220, 100);
                ctx.font = "20px Space Grotesk";
                ctx.fillText("Press Space to Restart", 200, 130);
                return;
            }

            // Clear
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Updates
            dino.update();
            dino.draw();

            spawnObstacle();

            // Obstacles
            for (let i = obstacles.length - 1; i >= 0; i--) {
                let obs = obstacles[i];
                obs.update();
                obs.draw();

                if (obs.x + obs.w < 0) {
                    obstacles.splice(i, 1);
                }
            }

            checkCollisions();

            // Score
            ctx.fillStyle = "#333";
            ctx.font = "20px Space Grotesk";
            ctx.fillText("Score: " + score, 500, 30);

            frames++;
            requestAnimationFrame(loop);
        }

        // Input
        window.addEventListener('keydown', e => {
            if (e.code === 'Space' || e.code === 'ArrowUp') {
                if (isGameOver) resetGame();
                else dino.jump();
            }
        });
        window.addEventListener('touchstart', e => {
            if (isGameOver) resetGame();
            else dino.jump();
        });

        // Start
        loop();

    </script>
</body>
</html>