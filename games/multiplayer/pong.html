<!DOCTYPE html>
<html>
<head>
    <title>Neon Pong (2P)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; overflow: hidden; background: #000; color: #fff; font-family: 'Space Grotesk', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
        canvas { border: 4px solid #fff; background: #000; box-shadow: 0 0 20px rgba(255,255,255,0.2); }
        .controls { position: absolute; top: 20px; width: 100%; display: flex; justify-content: space-between; padding: 0 50px; box-sizing: border-box; font-size: 1.2rem; color: #aaa; pointer-events: none; }
        .p1 { color: #00ff00; }
        .p2 { color: #ff00ff; }
        .back-btn { position: absolute; bottom: 20px; color: #555; text-decoration: none; font-weight: bold; pointer-events: auto; }
        .back-btn:hover { color: #fff; }
    </style>
</head>
<body>
    <div class="controls">
        <div class="p1">P1: W / S</div>
        <div class="p2">P2: UP / DOWN</div>
    </div>

    <canvas id="game" width="800" height="500"></canvas>
    
    <a href="../../index.html" class="back-btn">Exit Match</a>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');

        // Game Objects
        const paddleWidth = 15;
        const paddleHeight = 100;
        
        const p1 = { x: 20, y: 200, w: paddleWidth, h: paddleHeight, color: '#00ff00', score: 0, dy: 0 };
        const p2 = { x: 765, y: 200, w: paddleWidth, h: paddleHeight, color: '#ff00ff', score: 0, dy: 0 };
        const ball = { x: 400, y: 250, r: 10, dx: 5, dy: 5, speed: 7, color: '#fff' };
        
        // Input
        const keys = {};
        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);

        function resetBall() {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.speed = 7;
            ball.dx = (Math.random() > 0.5 ? 1 : -1) * ball.speed;
            ball.dy = (Math.random() > 0.5 ? 1 : -1) * ball.speed;
        }

        function update() {
            // Player 1 (W/S)
            if (keys['KeyW']) p1.y -= 8;
            if (keys['KeyS']) p1.y += 8;
            
            // Player 2 (ArrowUp/ArrowDown)
            if (keys['ArrowUp']) p2.y -= 8;
            if (keys['ArrowDown']) p2.y += 8;

            // Clamp Paddles
            p1.y = Math.max(0, Math.min(canvas.height - p1.h, p1.y));
            p2.y = Math.max(0, Math.min(canvas.height - p2.h, p2.y));

            // Move Ball
            ball.x += ball.dx;
            ball.y += ball.dy;

            // Wall Collision (Top/Bottom)
            if (ball.y - ball.r < 0 || ball.y + ball.r > canvas.height) {
                ball.dy *= -1;
            }

            // Paddle Collision
            let player = (ball.x < canvas.width / 2) ? p1 : p2;
            
            if (ball.x - ball.r < player.x + player.w && ball.x + ball.r > player.x &&
                ball.y + ball.r > player.y && ball.y - ball.r < player.y + player.h) {
                
                // Hit!
                // Calculate impact point (-1 to 1)
                let collidePoint = (ball.y - (player.y + player.h/2)) / (player.h/2);
                let angleRad = (Math.PI/4) * collidePoint;

                let direction = (ball.x < canvas.width/2) ? 1 : -1;
                
                ball.speed += 0.5; // Speed up
                ball.dx = direction * ball.speed * Math.cos(angleRad);
                ball.dy = ball.speed * Math.sin(angleRad);
            }

            // Scoring
            if (ball.x < 0) {
                p2.score++;
                resetBall();
            } else if (ball.x > canvas.width) {
                p1.score++;
                resetBall();
            }
        }

        function draw() {
            // Clear
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Net
            ctx.strokeStyle = '#333';
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.moveTo(canvas.width/2, 0);
            ctx.lineTo(canvas.width/2, canvas.height);
            ctx.stroke();
            ctx.setLineDash([]);

            // Scores
            ctx.font = "80px Space Grotesk";
            ctx.fillStyle = '#333';
            ctx.fillText(p1.score, canvas.width/4, 100);
            ctx.fillText(p2.score, 3*canvas.width/4, 100);

            // Paddles
            ctx.fillStyle = p1.color;
            ctx.shadowBlur = 20;
            ctx.shadowColor = p1.color;
            ctx.fillRect(p1.x, p1.y, p1.w, p1.h);
            
            ctx.fillStyle = p2.color;
            ctx.shadowColor = p2.color;
            ctx.fillRect(p2.x, p2.y, p2.w, p2.h);

            // Ball
            ctx.fillStyle = ball.color;
            ctx.shadowColor = '#fff';
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
            ctx.fill();
            
            ctx.shadowBlur = 0;
        }

        function loop() {
            update();
            draw();
            requestAnimationFrame(loop);
        }

        resetBall();
        loop();

    </script>
</body>
</html>
